# Cert-Manager Helm Chart values.yaml - Lokales Kubernetes Cluster
# Minimalistisch für Home Lab / Entwicklung
# Webhook Service für Port Forwarding
# Keine Ingress-Klasse erforderlich für lokales Setup

# ============================================================================
# Global Settings
# ============================================================================
global:
  # Keine Ingress-Klasse für lokales Cluster erforderlich
  ingressClass: ""
  
  # Leader Election für HA (optional für Home Lab)
  leaderElection: false

# ============================================================================
# Cert-Manager Controller
# ============================================================================
installCRDs: true  # WICHTIG: Installiert Certificate CRDs

replicaCount: 1

image:
  repository: quay.io/jetstack/cert-manager-controller
  tag: "v1.15.3"  # Aktuelle stabile Version (Jan 2026)
  pullPolicy: IfNotPresent

# Service Account
serviceAccount:
  create: true
  name: cert-manager
  annotations: {}

# Webhook Server (für Certificate Validation)
webhook:
  enabled: true
  
  # Service für Port Forwarding (falls nötig)
  service:
    type: ClusterIP
    port: 10250
    targetPort: 10250

# Ingress (optional - für lokales Setup deaktiviert)
ingressShim:
  default: false

# ============================================================================
# Resources - Home Lab optimiert
# ============================================================================
resources:
  limits:
    cpu: 200m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi

# ============================================================================
# Security Context
# ============================================================================
securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: false
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 2000

# Pod Security Context
podSecurityContext:
  fsGroup: 2000
  runAsNonRoot: true
  runAsUser: 1000
  seccompProfile:
    type: RuntimeDefault

# ============================================================================
# Node Selector / Tolerations (optional)
# ============================================================================
nodeSelector: {}

tolerations: []

affinity: {}

# ============================================================================
# RBAC
# ============================================================================
rbac:
  create: true
  # Cluster-wide Permissions für Certificate Signing
  clusterWide: true

# ============================================================================
# Additional Volumes & VolumeMounts (optional)
# ============================================================================
extraArgs:
  # Verbose Logging für Debugging
  - --v=2
  # Enable Leader Election (false für Single Node)
  - --leader-elect=false
  # Disable Caching für schnelleres Testing
  - --enable-certificate-owner-ref=true

# ============================================================================
# Monitoring (optional)
# ============================================================================
prometheus:
  enabled: false

# ============================================================================
# Priority Class (optional)
# ============================================================================
priorityClassName: ""

# ============================================================================
# Revision History
# ============================================================================
revisionHistoryLimit: 3

# ============================================================================
# Beispiel Certificate nach Installation
# ============================================================================
# Nach der Installation kannst du so ein Self-Signed Certificate erstellen:
#
# cat <<EOF | kubectl apply -f -
# apiVersion: cert-manager.io/v1
# kind: ClusterIssuer
# meta
#   name: selfsigned-issuer
# spec:
#   selfSigned: {}
# ---
# apiVersion: cert-manager.io/v1
# kind: Certificate
# meta
#   name: my-local-cert
#   namespace: default
# spec:
#   secretName: my-local-cert-tls
#   issuerRef:
#     name: selfsigned-issuer
#     kind: ClusterIssuer
#   commonName: argocd.local
# EOF
